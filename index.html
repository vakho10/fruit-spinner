<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fruit Emoji Spinner - Weekly Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        #gameContainer {
            position: relative;
            width: 100%;
            max-width: 1000px;
            height: 600px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px;
        }

        #gameCanvas {
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 1.5em;
            font-weight: bold;
        }

        .weekly-tracker {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            border: 2px solid rgba(255, 255, 255, 0.18);
            padding: 20px;
            min-width: 200px;
            animation: slideIn 0.8s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .tracker-title {
            color: white;
            font-size: 1.3em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .day-item {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 12px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
            min-height: 60px;
            position: relative;
            overflow: hidden;
        }

        .day-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .day-item.highlight::before {
            left: 100%;
        }

        .day-item.highlight {
            background: linear-gradient(135deg, #ff6b6b, #ff8e53);
            color: white;
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
        }

        .day-name {
            font-weight: 600;
            font-size: 1.1em;
            color: #333;
            flex: 1;
        }

        .day-item.highlight .day-name {
            color: white;
        }

        .day-result {
            display: flex;
            align-items: center;
            gap: 8px;
            opacity: 0;
            transform: translateX(20px);
            transition: all 0.5s ease;
        }

        .day-result.show {
            opacity: 1;
            transform: translateX(0);
        }

        .day-emoji {
            font-size: 1.8em;
        }

        .day-fruit-name {
            font-size: 0.9em;
            color: #555;
            font-weight: 500;
        }

        .day-item.highlight .day-fruit-name {
            color: rgba(255, 255, 255, 0.9);
        }

        .empty-state {
            color: #999;
            font-style: italic;
            font-size: 0.9em;
        }

        .reset-button {
            background: linear-gradient(45deg, #95a5a6, #7f8c8d);
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 0.9em;
            font-weight: bold;
            border-radius: 25px;
            cursor: pointer;
            margin-top: 15px;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .reset-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }

        .reset-button:active {
            transform: translateY(0);
        }
    </style>
</head>

<body>
<div id="gameContainer">
    <div class="loading">Loading...</div>
    <div class="weekly-tracker">
        <div class="tracker-title">📅 This Week's Spins</div>
        <div id="daysList"></div>
        <button class="reset-button" id="resetButton">Reset Week</button>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Fruit data with emojis and names
        const fruits = [
            { emoji: '🍎', name: 'Apple' },
            { emoji: '🍊', name: 'Orange' },
            { emoji: '🍋', name: 'Lemon' },
            { emoji: '🍌', name: 'Banana' },
            { emoji: '🍉', name: 'Watermelon' },
            { emoji: '🍇', name: 'Grapes' },
            { emoji: '🍓', name: 'Strawberry' },
            { emoji: '🍑', name: 'Peach' },
            { emoji: '🍒', name: 'Cherry' },
            { emoji: '🥝', name: 'Kiwi' },
            { emoji: '🍍', name: 'Pineapple' },
            { emoji: '🥭', name: 'Mango' }
        ];

        // Days of the week
        const daysOfWeek = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];

        // Weekly results storage
        let weeklyResults = {};
        let currentDayIndex = 0;

        // Initialize weekly results
        daysOfWeek.forEach(day => {
            weeklyResults[day] = null;
        });

        // Create DOM elements for weekly tracker
        function createWeeklyTracker() {
            const daysList = document.getElementById('daysList');
            daysList.innerHTML = '';

            daysOfWeek.forEach((day, index) => {
                const dayItem = document.createElement('div');
                dayItem.className = 'day-item';
                dayItem.id = `day-${index}`;

                const dayName = document.createElement('div');
                dayName.className = 'day-name';
                dayName.textContent = day;

                const dayResult = document.createElement('div');
                dayResult.className = 'day-result';
                dayResult.id = `result-${index}`;

                const emptyState = document.createElement('span');
                emptyState.className = 'empty-state';
                emptyState.textContent = 'No spin yet';
                dayResult.appendChild(emptyState);

                dayItem.appendChild(dayName);
                dayItem.appendChild(dayResult);
                daysList.appendChild(dayItem);
            });

            // Reset button functionality
            document.getElementById('resetButton').addEventListener('click', resetWeek);
        }

        function resetWeek() {
            weeklyResults = {};
            daysOfWeek.forEach(day => {
                weeklyResults[day] = null;
            });
            currentDayIndex = 0;

            // Clear all results
            daysOfWeek.forEach((day, index) => {
                const dayResult = document.getElementById(`result-${index}`);
                const dayItem = document.getElementById(`day-${index}`);
                dayResult.innerHTML = '<span class="empty-state">No spin yet</span>';
                dayResult.classList.remove('show');
                dayItem.classList.remove('highlight');
            });
        }

        function updateWeeklyResult(fruit) {
            const currentDay = daysOfWeek[currentDayIndex];
            weeklyResults[currentDay] = fruit;

            // Update DOM
            const dayResult = document.getElementById(`result-${currentDayIndex}`);
            const dayItem = document.getElementById(`day-${currentDayIndex}`);

            // Remove highlight from previous day
            if (currentDayIndex > 0) {
                const prevDayItem = document.getElementById(`day-${currentDayIndex - 1}`);
                prevDayItem.classList.remove('highlight');
            }

            // Update current day
            dayResult.innerHTML = `
                    <span class="day-emoji">${fruit.emoji}</span>
                    <span class="day-fruit-name">${fruit.name}</span>
                `;
            dayResult.classList.add('show');
            dayItem.classList.add('highlight');

            // Move to next day
            currentDayIndex = (currentDayIndex + 1) % daysOfWeek.length;

            // If we've completed a week, show a message
            if (currentDayIndex === 0) {
                setTimeout(() => {
                    // Could add a "Week Complete!" message here
                }, 1000);
            }
        }

        // Initialize weekly tracker
        createWeeklyTracker();

        // Phaser Scene Class
        class SpinnerScene extends Phaser.Scene {
            constructor() {
                super({ key: 'SpinnerScene' });

                // Initialize scene properties
                this.spinner = null;
                this.pointer = null;
                this.spinButton = null;
                this.bumps = [];
                this.fruitContainers = [];
                this.isSpinning = false;
                this.currentRotation = 0;
                this.confettiParticles = null;
                this.lastBumpIndex = -1;
                this.pointerBumpTween = null;
                this.resultContainer = null;
                this.resultEmoji = null;
                this.resultText = null;
                this.resultBackground = null;
            }

            preload() {
                // Create a simple texture for confetti
                const graphics = this.add.graphics();
                graphics.fillStyle(0xff6b6b);
                graphics.fillRect(0, 0, 10, 10);
                graphics.generateTexture('confetti', 10, 10);
                graphics.destroy();
            }

            create() {
                // Hide loading message
                document.querySelector('.loading').style.display = 'none';

                // Adjust game canvas position
                this.cameras.main.setPosition(0, 0);
                this.game.canvas.style.marginLeft = '0';

                // Create the spinner container
                const centerX = this.cameras.main.width / 2;
                const centerY = this.cameras.main.height / 2 - 50;

                // Create the background circle for the spinner
                const spinnerBg = this.add.circle(centerX, centerY, 160, 0xffffff, 0.1);
                spinnerBg.setStrokeStyle(2, 0xffffff, 0.18);

                // Create the spinner container
                this.spinner = this.add.container(centerX, centerY);

                // Create the fruit containers
                const angleStep = 360 / fruits.length;
                const radius = 120;

                fruits.forEach((fruit, index) => {
                    const angle = angleStep * index;
                    const angleRad = angle * Math.PI / 180;
                    const x = Math.cos(angleRad) * radius;
                    const y = Math.sin(angleRad) * radius;

                    // Create fruit container
                    const fruitContainer = this.add.container(x, y);

                    // Create circle behind fruit
                    const fruitCircle = this.add.circle(0, 0, 30, 0xffffff);
                    fruitCircle.setStrokeStyle(2, 0xc0c0c0);

                    // Create fruit text
                    const fruitText = this.add.text(0, 0, fruit.emoji, {
                        fontSize: '32px',
                        fontFamily: 'Arial'
                    }).setOrigin(0.5);

                    // Add to container
                    fruitContainer.add([fruitCircle, fruitText]);
                    this.spinner.add(fruitContainer);
                    this.fruitContainers.push(fruitContainer);

                    // Add hover effect
                    fruitCircle.setInteractive();
                    fruitCircle.on('pointerover', () => {
                        fruitCircle.setScale(1.1);
                        fruitText.setScale(1.2);
                    });
                    fruitCircle.on('pointerout', () => {
                        fruitCircle.setScale(1);
                        fruitText.setScale(1);
                    });
                });

                // Create bumps around the wheel
                const bumpCount = 24;
                const bumpRadius = 150;
                const bumpAngleStep = 360 / bumpCount;

                for (let i = 0; i < bumpCount; i++) {
                    const angle = bumpAngleStep * i;
                    const angleRad = angle * Math.PI / 180;
                    const x = Math.cos(angleRad) * bumpRadius;
                    const y = Math.sin(angleRad) * bumpRadius;

                    const bump = this.add.circle(x, y, 6, 0xffd700);
                    bump.setStrokeStyle(1, 0xffa500);
                    this.spinner.add(bump);
                    this.bumps.push(bump);
                }

                // Create the result display in the center (initially hidden)
                this.createResultDisplay(centerX, centerY);

                // Create the pointer
                const pointerGraphics = this.add.graphics();
                pointerGraphics.fillStyle(0xff6b6b);
                pointerGraphics.fillTriangle(0, 0, 20, -20, 20, 20);
                this.pointer = this.add.container(centerX + 160, centerY, [pointerGraphics]);

                // Create the spin button
                this.spinButton = this.add.text(centerX, centerY + 250, 'SPIN THE WHEEL!', {
                    fontSize: '24px',
                    fontFamily: 'Arial',
                    color: '#ffffff',
                    backgroundColor: '#ff6b6b',
                    padding: { x: 20, y: 10 }
                }).setOrigin(0.5);

                this.spinButton.setInteractive({ useHandCursor: true });
                this.spinButton.on('pointerdown', () => this.spin());
                this.spinButton.on('pointerover', () => {
                    this.spinButton.setStyle({ backgroundColor: '#ff8e53' });
                });
                this.spinButton.on('pointerout', () => {
                    this.spinButton.setStyle({ backgroundColor: '#ff6b6b' });
                });

                // Create particle system for confetti
                this.confettiParticles = this.add.particles('confetti');
            }

            createResultDisplay(x, y) {
                // Create the circular result container
                this.resultContainer = this.add.container(x, y);
                this.resultContainer.setAlpha(0);
                this.resultContainer.setScale(0);

                // Create background circle
                this.resultBackground = this.add.circle(0, 0, 80, 0xffffff, 0.95);
                this.resultBackground.setStrokeStyle(3, 0xff6b6b);

                // Create result text
                this.resultText = this.add.text(0, -20, 'You got:', {
                    fontSize: '18px',
                    fontFamily: 'Arial',
                    color: '#333333',
                    fontStyle: 'bold'
                }).setOrigin(0.5);

                // Create result emoji
                this.resultEmoji = this.add.text(0, 15, '', {
                    fontSize: '48px',
                    fontFamily: 'Arial'
                }).setOrigin(0.5);

                // Create fruit name
                this.resultName = this.add.text(0, 50, '', {
                    fontSize: '20px',
                    fontFamily: 'Arial',
                    color: '#555555',
                    fontStyle: 'bold'
                }).setOrigin(0.5);

                // Add all elements to container
                this.resultContainer.add([
                    this.resultBackground,
                    this.resultText,
                    this.resultEmoji,
                    this.resultName
                ]);

                // Add to scene at the correct depth (above spinner but below button)
                this.add.existing(this.resultContainer);
                this.resultContainer.setDepth(10);
            }

            update() {
                // This is called every frame
                // We can add continuous effects here if needed
            }

            spin() {
                if (this.isSpinning) return;

                this.isSpinning = true;
                this.spinButton.setAlpha(0.5);
                this.spinButton.disableInteractive();
                this.hideResult();
                this.lastBumpIndex = -1;

                // Calculate random spin parameters
                const minSpins = 5;
                const maxSpins = 8;
                const spins = Math.random() * (maxSpins - minSpins) + minSpins;
                const targetRotation = this.currentRotation + (spins * 360);

                // Add random final angle
                const randomAngle = Math.random() * 360;
                const finalTargetRotation = targetRotation + randomAngle;

                // Calculate which fruit will be selected
                const finalAngle = finalTargetRotation % 360;
                const angleStep = 360 / fruits.length;
                const selectedIndex = Math.round((360 - finalAngle) / angleStep) % fruits.length;
                const selectedFruit = fruits[selectedIndex];

                // Create the spinning animation with easing
                const duration = 4000; // 4 seconds
                const spinTween = this.tweens.add({
                    targets: this.spinner,
                    angle: finalTargetRotation,
                    duration: duration,
                    ease: 'Cubic.easeOut', // Smooth deceleration
                    onUpdate: (tween) => {
                        this.currentRotation = tween.getValue();

                        // Add bump effects during the first 90% of the animation
                        const progress = tween.progress;
                        if (progress < 0.9) {
                            this.checkBumpEffect();
                        }
                    },
                    onComplete: () => {
                        this.currentRotation = finalTargetRotation;
                        this.showResult(selectedFruit);
                        this.createConfetti();

                        // Update weekly tracker
                        updateWeeklyResult(selectedFruit);

                        this.isSpinning = false;
                        this.spinButton.setAlpha(1);
                        this.spinButton.setInteractive();
                    }
                });

                // Add pointer bump effect
                this.pointerBumpTween = this.tweens.add({
                    targets: this.pointer,
                    x: this.pointer.x - 5,
                    angle: -5,
                    duration: 100,
                    yoyo: true,
                    repeat: -1,
                    paused: false
                });

                // Stop pointer bump effect when spinning slows down
                this.time.delayedCall(duration * 0.9, () => {
                    if (this.pointerBumpTween) {
                        this.pointerBumpTween.stop();
                        this.pointer.x = this.cameras.main.width / 2 + 160;
                        this.pointer.angle = 0;
                    }
                });
            }

            checkBumpEffect() {
                const bumpAngleStep = 360 / this.bumps.length;
                const normalizedAngle = ((this.currentRotation % 360) + 360) % 360;
                const bumpIndex = Math.floor(normalizedAngle / bumpAngleStep);

                // Only trigger effect when passing a new bump
                if (bumpIndex !== this.lastBumpIndex) {
                    this.lastBumpIndex = bumpIndex;

                    // Activate bump visual effect
                    const bump = this.bumps[bumpIndex];
                    bump.setFillStyle(0xff6b6b);
                    bump.setScale(1.5);

                    this.time.delayedCall(100, () => {
                        bump.setFillStyle(0xffd700);
                        bump.setScale(1);
                    });
                }
            }

            showResult(fruit) {
                // Update result content
                this.resultEmoji.setText(fruit.emoji);
                this.resultName.setText(fruit.name);

                // Animate the result appearance
                this.tweens.add({
                    targets: this.resultContainer,
                    alpha: 1,
                    scaleX: 1,
                    scaleY: 1,
                    duration: 500,
                    ease: 'Back.easeOut',
                    onComplete: () => {
                        // Add a subtle pulse animation
                        this.tweens.add({
                            targets: this.resultBackground,
                            scaleX: 1.05,
                            scaleY: 1.05,
                            duration: 1000,
                            yoyo: true,
                            repeat: -1,
                            ease: 'Sine.easeInOut'
                        });
                    }
                });

                // Animate the emoji with a bounce
                this.tweens.add({
                    targets: this.resultEmoji,
                    scaleX: 1.3,
                    scaleY: 1.3,
                    duration: 300,
                    ease: 'Back.easeOut',
                    yoyo: true,
                    repeat: 0
                });
            }

            hideResult() {
                // Hide the result with animation
                this.tweens.add({
                    targets: this.resultContainer,
                    alpha: 0,
                    scaleX: 0,
                    scaleY: 0,
                    duration: 300,
                    ease: 'Back.easeIn'
                });
            }

            createConfetti() {
                // Create confetti particles
                const colors = [0xff6b6b, 0x4ecdc4, 0x45b7d1, 0x96ceb4, 0xffeaa7, 0xdfe6e9];

                const emitter = this.confettiParticles.createEmitter({
                    x: { min: 100, max: 700 },
                    y: 0,
                    lifespan: 3000,
                    speedY: { min: 100, max: 300 },
                    speedX: { min: -50, max: 50 },
                    gravityY: 200,
                    scale: { start: 1, end: 0.5 },
                    quantity: 30,
                    frequency: 50,
                    tint: colors,
                    blendMode: 'NORMAL',
                    on: false
                });

                // Start the emitter
                emitter.start();

                // Stop the emitter after all particles are emitted
                this.time.delayedCall(1500, () => {
                    emitter.stop();
                });
            }
        }

        // Game configuration
        const config = {
            type: Phaser.AUTO,
            width: 700,
            height: 600,
            parent: 'gameContainer',
            backgroundColor: 'rgba(0, 0, 0, 0)',
            scene: [SpinnerScene],
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: { y: 300 },
                    debug: false
                }
            }
        };

        // Initialize the game
        const game = new Phaser.Game(config);
    });
</script>
</body>

</html>